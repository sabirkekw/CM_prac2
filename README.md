# Конфигурационное управление - Практическая работа №3

# Вариант №16: Разработка ассемблера и интерпретатора для учебной виртуальной машины (УВМ)

## Цель этапа 

Создать CLI-приложение ассемблера, реализовать разбор текстового представления команд и трансляцию в промежуточное представление.

## Спецификация УВМ для варианта №16

1. Загрузка константы
```
| A    | B    | C    |
|------|------|------|
| Биты 0—2   | Биты 3—26   | Биты 27—31   |
| 7    | Константа    | Адрес    |
```
- Размер команды: 4 байта
- Операнд: поле B (константа)
- Результат: регистр по адресу, которым является поле C
- Тест: (A=7, B=964, C=26) → 0x27, 0x1E, 0x00, 0xD0
2. Чтение значения из памяти
```
| A    | B    | C    | D    |
|------|------|------|------|
| Биты 0—2   | Биты 3—7   | Биты 8—18   | Биты 19—23   |
| 1    | Адрес    | Смещение    | Адрес    |
```
- Размер команды: 3 байта
- Операнд: значение в памяти по адресу, которым является сумма адреса (регистр B) и смещения (поле C)
- Результат: регистр по адресу, которым является поле D
- Тест: (A=1, B=16, C=280, D=3) → 0x81, 0x18, 0x19
3. Запись значения в память
```
| A    | B    | C    |
|------|------|------|
| Биты 0—2   | Биты 3—7   | Биты 8—12   |
| 0    | Адрес    | Адрес    |
```
- Размер команды: 2 байта
- Операнд: регистр по адресу, которым является поле B
- Результат: значение в памяти по адресу, которым является регистр по адресу, которым является поле C
- Тест: (A=0, B=26, C=17) → 0xD0, 0x11
4. Унарная операция popcnt()
```
| A    | B    | C    |
|------|------|------|
| Биты 0—2   | Биты 3—7   | Биты 8—12   |
| 5    | Адрес    | Адрес    |
```
- Размер команды: 2 байта
- Операнд: значение в памяти по адресу, которым является регистр по адресу, которым является поле B
- Результат: регистр по адресу, которым является поле C
- Тест: (A=5, B=21, C=1) → 0xAD, 0x01
## Ключевые файлы
1. vm_spec.py - содержит:
- Спецификацию команд УВМ
- Константы для каждой команды (opcode, размер, поля)
- Функции для работы с битовыми полями
2. assembler.py - содержит:
- Класс Assembler для трансляции ассемблерного кода
- Метод parse_csv_line() для разбора строк CSV
- Метод assemble_from_csv() для обработки файла
- Метод print_intermediate_representation() для вывода промежуточного представления
3. test_asm.py - содержит:
- Тесты для проверки корректности разбора команд
- Проверку соответствия тестовым данным из спецификации

## Пример тестовой программы
```
# examples/test1.csv
# Загрузка константы
LOAD, 964, 26

# Чтение из памяти
READ, 16, 280, 3

# Запись в память
WRITE, 26, 17

# Подсчет единичных битов
POPCNT, 21, 1
```
